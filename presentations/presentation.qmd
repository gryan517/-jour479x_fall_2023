##Data Backgrounding 
Do successful (winning) Big Ten/top 10 teams rely on their first-year players more than others? 

```{r}
library(tidyverse)
library(dplyr)
library(scales)
```


```{r}
ncaa_players_2023 <- read_csv ("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_playerstats_2023.csv")
```

```{r}
head(ncaa_players_2023)
```
```{r}
ncaa_players_2023|>
  group_by(team, yr) |>
  summarise(
    total = n()
  ) 
```
#The general overview

Here I am creating a graph to demonstrate the relationship between each year for each of the top 10 teams.The graph displays the amount of goals each of the years makes in comparison to one another on each team. 

```{r}
player_goals_2023 <- ncaa_players_2023|>
  group_by(team, yr) |>
  filter(!is.na(goals))|>
   mutate(
    goalspergame = goals/games)
```

Basically what I want to see is from each team, the avg amount of goals for each game by team and yr. I wouldn't do it for the NCAA entirely because 1. Looking at the teams separately tells more of a story (we can see if one team relies on one year more than another) 2. We can easily narrow it down to the big 10 teams or the top 10 teams.


##Narrowing it down
```{r}
team_gpg_2023 <- player_goals_2023 |>
  group_by(team, yr)|> 
  summarise(
    total_goals = sum(goals), 
    total_games = max(games), 
    team_gpg = total_goals/total_games) |>
  arrange(desc(team_gpg))
```
##Highest scoring offensive 
```{r}
ggplot() + geom_point(data=team_gpg_2023, aes(x=total_goals, y=total_games))
```
##Big Ten
```{r}
big_ten_gpg_2023 <- team_gpg_2023 |>
  filter(
    yr == "Fr" |
    yr == "Sr" |
    yr == "So" | 
    yr == "Jr") |>
  filter(
    team == "Ohio St. Buckeyes" |
    team == "Michigan St. Spartans" |
    team == "Penn St. Nittany Lions" |
    team == "Rutgers Scarlet Knights" |
    team == "Maryland Terrapins, Terps" |
    team == "Michigan St. Spartans" |
    team == "Indiana Hoosiers" |
    team == "Iowa Hawkeyes" |
    team == "Wisconsin Badgers" |
    team == "Minnesota Golden Gophers" |
    team == "Nebraska Huskers" |
    team == "Northwestern Wildcats" |
    team == "Illinois St. Redbirds" |
    team == "Purdue Boilermakers"
  ) |>
  arrange(desc(team_gpg))
```

```{r}
ggplot() + geom_point(data=big_ten_gpg_2023, aes(x=total_goals, y=total_games))
```

```{r}
top10 <- team_gpg_2023 |>
  filter(team_gpg>=0.4385965) |>
  arrange(desc(team_gpg))
```

```{r}
ggplot() + 
  geom_bar(
    data=top10, 
    aes(x=reorder(team, team_gpg), weight=team_gpg)) + 
  coord_flip() + 
  scale_y_continuous(labels=comma) + 
  labs(
    title="", 
    x="Team", 
    y="Goals per Game"
)
```

```{r}
team_fr_goals_2023 <- player_goals_2023 |>
   filter(yr == "Fr") |>
   group_by(team)|>
  summarise(total_first_year_goals = sum(goals))|>
  arrange(desc(total_first_year_goals)) |>
  head(10)
```


```{r}
ggplot() + 
  geom_bar(
    data=top10fr, 
    aes(x=reorder(team, total_first_year_goals), weight=total_first_year_goals)) + 
  coord_flip() + 
  scale_y_continuous(labels=comma) + 
  labs(
    title="", 
    x="Team", 
    y="Goals per Game")
```

```{r}
combined <- team_gpg_2023 |> left_join(team_fr_goals_2023, join_by(team))
```


```{r}
team_fr_pct <- combined |>
 mutate(total_first_year_goals = replace_na(total_first_year_goals, 0)) |> 
  mutate(fr_pct = (total_first_year_goals/total_goals)*100)|>
  arrange(desc(fr_pct))
```

```{r}
ggplot() + geom_point(data=team_fr_pct, aes(x=total_goals, y=total_first_year_goals)) +
  geom_smooth(data=team_fr_pct, aes(x=total_goals, y=total_first_year_goals), method="lm") + 
  scale_y_continuous(labels=comma) + 
  labs(
    title="", 
    x="Total Goals", 
    y="Total First Year Goals")
```


```{r}
delaware <- team_fr_pct |> filter(team == "Delaware St. Hornets")
```

```{r}
ggplot() + geom_point(data=team_fr_pct, aes(x=total_goals, y=total_first_year_goals)) +
  geom_smooth(data=team_fr_pct, aes(x=total_goals, y=total_first_year_goals), method="lm") +
  geom_point(data=delaware, aes(x=total_goals, y=total_first_year_goals), color="red") + 
  scale_y_continuous(labels=comma) + 
  labs(
    title="", 
    x="Total Goals", 
    y="Total First Year Goals")
```

##What About Big Ten Teams?
```{r}
byyr <- ncaa_players_2023 |>
  group_by(team, yr) |>
  summarize(
    team_gpg = goals/games) |>
  filter(
    yr == "Fr" |
    yr == "Sr" |
    yr == "So" | 
    yr == "Jr") |>
  filter(
    team == "Ohio St. Buckeyes" |
    team == "Michigan St. Spartans" |
    team == "Penn St. Nittany Lions" |
    team == "Rutgers Scarlet Knights" |
    team == "Maryland Terrapins, Terps" |
    team == "Michigan St. Spartans" |
    team == "Indiana Hoosiers" |
    team == "Iowa Hawkeyes" |
    team == "Wisconsin Badgers" |
    team == "Minnesota Golden Gophers" |
    team == "Nebraska Huskers" |
    team == "Northwestern Wildcats" |
    team == "Illinois St. Redbirds" |
    team == "Purdue Boilermakers"
  )
```
Here I am creating a graph to demonstrate the relationship between each year for each of the Big 10 teams.The graph displays the amount of goals each of the years makes in comparison to one another on each team. 
```{r}
ggplot() + 
  geom_bar(
    data=byyr, 
    aes(x=reorder(team, team_gpg), weight=team_gpg, fill=yr)) + 
  coord_flip()
```

So now that we have a graph that represents the amount of goals each year from each team, I think this can more accurately represent the data I would like to display. Lets see how each year contributes to assists... 


##assists by year
```{r}
ncaa_players_2023|>
  group_by(team, yr) |>
  mutate(assists <- assists %>% replace(is.na(.), 0)) |>
  summarise(
    total = n()
  ) 
```


```{r}
assistsbyyr <- ncaa_players_2023 |>
  group_by(team, yr) |>
  summarize(
    team_gpg = goals/games) |>
  filter(
    yr == "Fr" |
    yr == "Sr" |
    yr == "So" | 
    yr == "Jr") |>
  filter(
    team == "Ohio St. Buckeyes" |
    team == "Michigan St. Spartans" |
    team == "Penn St. Nittany Lions" |
    team == "Rutgers Scarlet Knights" |
    team == "Maryland Terrapins, Terps" |
    team == "Michigan St. Spartans" |
    team == "Indiana Hoosiers" |
    team == "Iowa Hawkeyes" |
    team == "Wisconsin Badgers" |
    team == "Minnesota Golden Gophers" |
    team == "Nebraska Huskers" |
    team == "Northwestern Wildcats" |
    team == "Illinois St. Redbirds" |
    team == "Purdue Boilermakers"
  )
```

```{r}
ggplot() + 
  geom_bar(
    data=assistsbyyr, 
    aes(x=reorder(team, assistspergame), weight=assistspergame, fill=yr)) + 
  coord_flip()
```
Here we can see how each year contributes to to assists for the season, in comparison with the each year and each team. 
Questions: Where in this data do you see a story? 
Are Freshman a significant contributor to a teams success?/Does this data need more support to answer that? 


